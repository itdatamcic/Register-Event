<!DOCTYPE html>
<html lang="th">
<head>
┬а ┬а <meta charset="UTF-8">
┬а ┬а <meta name="viewport" content="width=device-width, initial-scale=1.0">
┬а ┬а <title>MCIC-Register</title>

┬а ┬а <link rel="icon" type="image/png" href="https://img5.pic.in.th/file/secure-sv1/-72f36e2606e6a703c.png">

┬а ┬а <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
┬а ┬а <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
┬а ┬а <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
┬а ┬а <link rel="preconnect" href="https://fonts.googleapis.com">
┬а ┬а <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
┬а ┬а <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
┬а ┬а <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

┬а ┬а <style>
┬а ┬а ┬а ┬а :root {
┬а ┬а ┬а ┬а ┬а ┬а --primary-color: #2c3e50;
┬а ┬а ┬а ┬а ┬а ┬а --secondary-color: #3498db;
┬а ┬а ┬а ┬а ┬а ┬а --background-color: #ecf0f1;
┬а ┬а ┬а ┬а ┬а ┬а --form-background: #ffffff;
┬а ┬а ┬а ┬а ┬а ┬а --input-border-color: #bdc3c7;
┬а ┬а ┬а ┬а ┬а ┬а --input-focus-color: #3498db;
┬а ┬а ┬а ┬а ┬а ┬а --text-color: #2c3e50;
┬а ┬а ┬а ┬а ┬а ┬а --label-color: #555;
┬а ┬а ┬а ┬а ┬а ┬а --danger-color: #e74c3c;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а body {
┬а ┬а ┬а ┬а ┬а ┬а font-family: 'Sarabun', sans-serif;
┬а ┬а ┬а ┬а ┬а ┬а background-color: var(--background-color);
┬а ┬а ┬а ┬а ┬а ┬а color: var(--text-color);
┬а ┬а ┬а ┬а ┬а ┬а display: flex;
┬а ┬а ┬а ┬а ┬а ┬а justify-content: center;
┬а ┬а ┬а ┬а ┬а ┬а align-items: center;
┬а ┬а ┬а ┬а ┬а ┬а min-height: 100vh;
┬а ┬а ┬а ┬а ┬а ┬а padding: 1rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .form-container {
┬а ┬а ┬а ┬а ┬а ┬а background-color: var(--form-background);
┬а ┬а ┬а ┬а ┬а ┬а padding: 2.5rem 3rem;
┬а ┬а ┬а ┬а ┬а ┬а max-width: 700px;
┬а ┬а ┬а ┬а ┬а ┬а width: 100%;
┬а ┬а ┬а ┬а ┬а ┬а margin: 2rem auto;
┬а ┬а ┬а ┬а ┬а ┬а border-radius: 15px;
┬а ┬а ┬а ┬а ┬а ┬а box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
┬а ┬а ┬а ┬а ┬а ┬а border-top: 5px solid var(--secondary-color);
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .logo-container {
┬а ┬а ┬а ┬а ┬а ┬а text-align: center;
┬а ┬а ┬а ┬а ┬а ┬а margin-bottom: 1rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .logo-img {
┬а ┬а ┬а ┬а ┬а ┬а max-width: 120px;
┬а ┬а ┬а ┬а ┬а ┬а height: auto;
┬а ┬а ┬а ┬а ┬а ┬а border-radius: 50%;
┬а ┬а ┬а ┬а ┬а ┬а box-shadow: 0 4px 10px rgba(0,0,0,0.08);
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .form-title {
┬а ┬а ┬а ┬а ┬а ┬а text-align: center;
┬а ┬а ┬а ┬а ┬а ┬а font-weight: 700;
┬а ┬а ┬а ┬а ┬а ┬а margin-bottom: 2.5rem;
┬а ┬а ┬а ┬а ┬а ┬а color: var(--primary-color);
┬а ┬а ┬а ┬а ┬а ┬а font-size: 2rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .form-label {
┬а ┬а ┬а ┬а ┬а ┬а font-weight: 500;
┬а ┬а ┬а ┬а ┬а ┬а color: var(--label-color);
┬а ┬а ┬а ┬а ┬а ┬а margin-bottom: .5rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .form-control, .custom-select, .select2-container .select2-selection--single {
┬а ┬а ┬а ┬а ┬а ┬а border-radius: 8px;
┬а ┬а ┬а ┬а ┬а ┬а height: 48px;
┬а ┬а ┬а ┬а ┬а ┬а border: 1px solid var(--input-border-color);
┬а ┬а ┬а ┬а ┬а ┬а transition: all 0.3s ease;
┬а ┬а ┬а ┬а ┬а ┬а background-color: #f8f9fa;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .form-control:focus, .custom-select:focus, .select2-container--default .select2-selection--single:focus {
┬а ┬а ┬а ┬а ┬а ┬а box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
┬а ┬а ┬а ┬а ┬а ┬а border-color: var(--input-focus-color);
┬а ┬а ┬а ┬а ┬а ┬а background-color: var(--form-background);
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а .select2-container--default .select2-selection--single {
┬а ┬а ┬а ┬а ┬а ┬а border: 1px solid var(--input-border-color);
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .select2-container--default .select2-selection--single .select2-selection__rendered {
┬а ┬а ┬а ┬а ┬а ┬а line-height: 46px;
┬а ┬а ┬а ┬а ┬а ┬а padding-left: 1rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .select2-container--default .select2-selection--single .select2-selection__arrow {
┬а ┬а ┬а ┬а ┬а ┬а height: 46px;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а .btn-submit {
┬а ┬а ┬а ┬а ┬а ┬а background: var(--secondary-color);
┬а ┬а ┬а ┬а ┬а ┬а border: none;
┬а ┬а ┬а ┬а ┬а ┬а border-radius: 8px;
┬а ┬а ┬а ┬а ┬а ┬а padding: 12px 30px;
┬а ┬а ┬а ┬а ┬а ┬а font-weight: 700;
┬а ┬а ┬а ┬а ┬а ┬а color: white;
┬а ┬а ┬а ┬а ┬а ┬а width: 100%;
┬а ┬а ┬а ┬а ┬а ┬а transition: all 0.3s ease;
┬а ┬а ┬а ┬а ┬а ┬а box-shadow: 0 4px 15px rgba(52, 152, 219, 0.2);
┬а ┬а ┬а ┬а ┬а ┬а font-size: 1.1rem;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .btn-submit:hover {
┬а ┬а ┬а ┬а ┬а ┬а transform: translateY(-3px);
┬а ┬а ┬а ┬а ┬а ┬а box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
┬а ┬а ┬а ┬а ┬а ┬а background: #2980b9;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а label.required::after {
┬а ┬а ┬а ┬а ┬а ┬а content: " *";
┬а ┬а ┬а ┬а ┬а ┬а color: var(--danger-color);
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а .input-group .btn-location {
┬а ┬а ┬а ┬а ┬а ┬а border-top-right-radius: 8px;
┬а ┬а ┬а ┬а ┬а ┬а border-bottom-right-radius: 8px;
┬а ┬а ┬а ┬а ┬а ┬а background-color: var(--secondary-color);
┬а ┬а ┬а ┬а ┬а ┬а color: white;
┬а ┬а ┬а ┬а ┬а ┬а border: none;
┬а ┬а ┬а ┬а ┬а ┬а width: 50px;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а .input-group .btn-location:hover {
┬а ┬а ┬а ┬а ┬а ┬а background-color: #2980b9;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а .input-group .form-control {
┬а ┬а ┬а ┬а ┬а ┬а border-right: none;
┬а ┬а ┬а ┬а }

┬а ┬а </style>
</head>
<body>

<div class="container">
┬а ┬а <div class="form-container">
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а <div class="logo-container">
┬а ┬а ┬а ┬а ┬а ┬а <img src="https://img2.pic.in.th/pic/modern-cass-international-cosmetic-vietnam_400x400_341568856.png?text=YOUR+LOGO" alt="Logo" class="logo-img">
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <h3 class="form-title">р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕гр╣Ир╕зр╕бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б</h3>

┬а ┬а ┬а ┬а <form method="post" autocomplete="off" name="data-sheet" id="registerForm">
┬а ┬а ┬а ┬а ┬а ┬а <input type="hidden" name="userID" id="userID">
┬а ┬а ┬а ┬а ┬а ┬а <input type="hidden" name="profileLine" id="profileLine">

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-row">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="fullName" class="form-label required">р╕Кр╕╖р╣Ир╕н-р╕кр╕Бр╕╕р╕е</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="text" class="form-control" id="fullName" name="р╕Кр╕╖р╣Ир╕н-р╕кр╕Бр╕╕р╕е" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="shopName" class="form-label required">р╕Кр╕╖р╣Ир╕нр╕гр╣Йр╕▓р╕Щр╣Ар╕кр╕гр╕┤р╕бр╕кр╕зр╕в/р╕Ър╕▓р╕гр╣Мр╣Ар╕Ър╕нр╕гр╣М</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="text" class="form-control" id="shopName" name="р╕Кр╕╖р╣Ир╕нр╕гр╣Йр╕▓р╕Щр╣Ар╕кр╕гр╕┤р╕бр╕кр╕зр╕в/р╕Ър╕▓р╕гр╣Мр╣Ар╕Ър╕нр╕гр╣М" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="checkin" class="form-label required">р╣Ар╕Кр╣Зр╕Др╕нр╕┤р╕Щ</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="input-group">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="text" class="form-control" id="checkin" name="р╣Ар╕Кр╣Зр╕Др╕нр╕┤р╕Щ" placeholder="р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б ЁЯУН р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕░р╕Ър╕╕р╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З" readonly required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="input-group-append">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <button class="btn btn-outline-secondary btn-location" type="button" id="getLocationBtn"><i class="fas fa-map-marker-alt"></i></button>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div id="eventResult" style="display:none;">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а<input type="hidden" id="eventLocation" name="р╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕Ир╕▒р╕Фр╕Зр╕▓р╕Щ">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а<input type="hidden" id="memo" name="Memo">
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-row">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="province" class="form-label required">р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <select class="custom-select" id="province" name="р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф --</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </select>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="district" class="form-label required">р╕нр╕│р╣Ар╕ар╕н</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <select class="custom-select" id="district" name="р╕нр╕│р╣Ар╕ар╕н" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕нр╕│р╣Ар╕ар╕н --</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </select>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-row">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="subdistrict" class="form-label required">р╕Хр╕│р╕Ър╕е</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <select class="custom-select" id="subdistrict" name="р╕Хр╕│р╕Ър╕е" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕Хр╕│р╕Ър╕е --</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </select>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="zipcode" class="form-label required">р╕гр╕лр╕▒р╕кр╣Др╕Ыр╕гр╕йр╕Ур╕╡р╕вр╣М</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="text" class="form-control" id="zipcode" name="р╕гр╕лр╕▒р╕кр╣Др╕Ыр╕гр╕йр╕Ур╕╡р╕вр╣М" readonly required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="address" class="form-label required">р╕Ър╣Йр╕▓р╕Щр╣Ар╕ер╕Вр╕Чр╕╡р╣И</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="text" class="form-control" id="address" name="р╕Ър╣Йр╕▓р╕Щр╣Ар╕ер╕Вр╕Чр╕╡р╣И" required>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-row">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="phone" class="form-label required">р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="tel" class="form-control" id="phone" name="р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group col-md-6">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="age" class="form-label required">р╕нр╕▓р╕вр╕╕</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="number" class="form-control" id="age" name="р╕нр╕▓р╕вр╕╕" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="form-group">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label for="status" class="form-label required">р╕кр╕Цр╕▓р╕Щр╕░</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <select class="custom-select" id="status" name="р╕кр╕Цр╕▓р╕Щр╕░" required>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="">-- р╣Ар╕ер╕╖р╕нр╕Бр╕кр╕Цр╕▓р╕Щр╕░ --</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ">р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <option value="р╕Ьр╕╣р╣Йр╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕бр╕Зр╕▓р╕Щ">р╕Ьр╕╣р╣Йр╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕бр╕Зр╕▓р╕Щ</option>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </select>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <div class="text-center mt-4">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <button type="submit" class="btn btn-submit">р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е</button>
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а </form>
┬а ┬а </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
┬а ┬а // JavaScript remains unchanged
┬а ┬а async function main() {
┬а ┬а ┬а ┬а await liff.init({ liffId: "2008243853-w5KYZ5oN" });
┬а ┬а ┬а ┬а if (!liff.isLoggedIn()) {
┬а ┬а ┬а ┬а ┬а ┬а liff.login();
┬а ┬а ┬а ┬а } else {
┬а ┬а ┬а ┬а ┬а ┬а const profile = await liff.getProfile();
┬а ┬а ┬а ┬а ┬а ┬а document.getElementById('userID').value = profile.userId;
┬а ┬а ┬а ┬а ┬а ┬а document.getElementById('profileLine').value = profile.displayName;
┬а ┬а ┬а ┬а }
┬а ┬а }
┬а ┬а main();

┬а ┬а const scriptURL = 'https://script.google.com/macros/s/AKfycbzGkfvuU3-BbGw2v4C4L0hUv5TG7Fgk5UOFHhSd67xlgu0AkxjXGUFhmJMN5Lg62t6g/exec';
┬а ┬а const form = document.forms['data-sheet'];
┬а ┬а let addressData = [];
┬а ┬а let eventLocationsData = [];

┬а ┬а $(document).ready(function() {
┬а ┬а ┬а ┬а $('#province, #district, #subdistrict, #status').select2({
┬а ┬а ┬а ┬а ┬а ┬а ┬а minimumResultsForSearch: Infinity┬а
┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а $('#province, #district, #subdistrict').select2();

┬а ┬а ┬а ┬а const addressDataUrl = scriptURL + '?action=getAddressData';
┬а ┬а ┬а ┬а fetch(addressDataUrl)
┬а ┬а ┬а ┬а ┬а ┬а .then(response => response.json())
┬а ┬а ┬а ┬а ┬а ┬а .then(data => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if (data && data.length > 0) {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а addressData = data;
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а populateProvinces();
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а })
┬а ┬а ┬а ┬а ┬а ┬а .catch(err => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а console.error('Failed to load address data:', err);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.fire('р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф!', `р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╣Др╕Фр╣Й: ${err.message}`, 'error');
┬а ┬а ┬а ┬а ┬а ┬а });

┬а ┬а ┬а ┬а const eventLocationsUrl = scriptURL + '?action=getEventLocations';
┬а ┬а ┬а ┬а fetch(eventLocationsUrl)
┬а ┬а ┬а ┬а ┬а ┬а .then(res => res.json())
┬а ┬а ┬а ┬а ┬а ┬а .then(data => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а eventLocationsData = data;
┬а ┬а ┬а ┬а ┬а ┬а }).catch(err => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а console.error('р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕Ир╕▒р╕Фр╕Зр╕▓р╕Щр╣Др╕Фр╣Й:', err);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬аSwal.fire('р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф!', `р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕Ир╕▒р╕Фр╕Зр╕▓р╕Щр╣Др╕Фр╣Й`, 'error');
┬а ┬а ┬а ┬а ┬а ┬а });
┬а ┬а });

┬а ┬а function populateProvinces() {
┬а ┬а ┬а ┬а const provinces = [...new Set(addressData.map(row => row[0]))].sort();
┬а ┬а ┬а ┬а provinces.forEach(province => {
┬а ┬а ┬а ┬а ┬а ┬а $('#province').append(new Option(province, province));
┬а ┬а ┬а ┬а });
┬а ┬а }

┬а ┬а $('#province').on('change', function() {
┬а ┬а ┬а ┬а const selectedProvince = $(this).val();
┬а ┬а ┬а ┬а $('#district').html('<option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕нр╕│р╣Ар╕ар╕н --</option>').val('').trigger('change');
┬а ┬а ┬а ┬а $('#subdistrict').html('<option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕Хр╕│р╕Ър╕е --</option>').val('').trigger('change');
┬а ┬а ┬а ┬а $('#zipcode').val('');
┬а ┬а ┬а ┬а if (!selectedProvince) return;
┬а ┬а ┬а ┬а const districts = [...new Set(addressData.filter(row => row[0] === selectedProvince).map(row => row[1]))].sort();
┬а ┬а ┬а ┬а districts.forEach(district => {
┬а ┬а ┬а ┬а ┬а ┬а $('#district').append(new Option(district, district));
┬а ┬а ┬а ┬а });
┬а ┬а });

┬а ┬а $('#district').on('change', function() {
┬а ┬а ┬а ┬а const selectedProvince = $('#province').val();
┬а ┬а ┬а ┬а const selectedDistrict = $(this).val();
┬а ┬а ┬а ┬а $('#subdistrict').html('<option value="">-- р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕Хр╕│р╕Ър╕е --</option>').val('').trigger('change');
┬а ┬а ┬а ┬а $('#zipcode').val('');
┬а ┬а ┬а ┬а if (!selectedDistrict) return;
┬а ┬а ┬а ┬а const subdistricts = [...new Set(addressData.filter(row => row[0] === selectedProvince && row[1] === selectedDistrict).map(row => row[2]))].sort();
┬а ┬а ┬а ┬а subdistricts.forEach(subdistrict => {
┬а ┬а ┬а ┬а ┬а ┬а $('#subdistrict').append(new Option(subdistrict, subdistrict));
┬а ┬а ┬а ┬а });
┬а ┬а });

┬а ┬а $('#subdistrict').on('change', function() {
┬а ┬а ┬а ┬а const selectedProvince = $('#province').val();
┬а ┬а ┬а ┬а const selectedDistrict = $('#district').val();
┬а ┬а ┬а ┬а const selectedSubdistrict = $(this).val();
┬а ┬а ┬а ┬а const match = addressData.find(row => row[0] === selectedProvince && row[1] === selectedDistrict && row[2] === selectedSubdistrict);
┬а ┬а ┬а ┬а $('#zipcode').val(match ? match[3] : '');
┬а ┬а });

┬а ┬а function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
┬а ┬а ┬а var R = 6371;
┬а ┬а ┬а var dLat = (lat2 - lat1) * (Math.PI / 180);
┬а ┬а ┬а var dLon = (lon2 - lon1) * (Math.PI / 180);
┬а ┬а ┬а var a =
┬а ┬а ┬а ┬а Math.sin(dLat / 2) * Math.sin(dLat / 2) +
┬а ┬а ┬а ┬а Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *
┬а ┬а ┬а ┬а Math.sin(dLon / 2) * Math.sin(dLon / 2);
┬а ┬а ┬а var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
┬а ┬а ┬а return R * c;
┬а ┬а }

┬а ┬а $('#getLocationBtn').on('click', function() {
┬а ┬а ┬а ┬а if (!navigator.geolocation) {
┬а ┬а ┬а ┬а ┬а ┬а return Swal.fire('р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф', 'р╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Др╕бр╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ Geolocation', 'error');
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а if (eventLocationsData.length === 0) {
┬а ┬а ┬а ┬а ┬а ┬а return Swal.fire('р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф', 'р╕Бр╕гр╕╕р╕Ур╕▓р╕гр╕нр╕кр╕▒р╕Бр╕Др╕гр╕╣р╣И р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ', 'info');
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а Swal.fire({
┬а ┬а ┬а ┬а ┬а ┬а title: 'р╕Бр╕│р╕ер╕▒р╕Зр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З',
┬а ┬а ┬а ┬а ┬а ┬а text: 'р╕Бр╕гр╕╕р╕Ур╕▓р╕гр╕нр╕кр╕▒р╕Бр╕Др╕гр╕╣р╣И...',
┬а ┬а ┬а ┬а ┬а ┬а allowOutsideClick: false,
┬а ┬а ┬а ┬а ┬а ┬а didOpen: () => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.showLoading();
┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а $('#checkin, #eventLocation, #memo').val('');
┬а ┬а ┬а ┬а navigator.geolocation.getCurrentPosition(position => {
┬а ┬а ┬а ┬а ┬а ┬а const userLat = position.coords.latitude;
┬а ┬а ┬а ┬а ┬а ┬а const userLon = position.coords.longitude;
┬а ┬а ┬а ┬а ┬а ┬а let foundLocation = false;
┬а ┬а ┬а ┬а ┬а ┬а setTimeout(() => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а for (const event of eventLocationsData) {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const eventName = event[0];
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const eventCoords = event[1].split(',').map(coord => parseFloat(coord.trim()));
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const eventMemo = event[2];
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const eventLat = eventCoords[0];
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const eventLon = eventCoords[1];
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const distance = getDistanceFromLatLonInKm(userLat, userLon, eventLat, eventLon);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if (distance <= 10) {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а $('#checkin').val(`${userLat}, ${userLon}`);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а $('#eventLocation').val(eventName);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а $('#memo').val(eventMemo);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.fire({
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а icon: 'success',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а title: 'р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И!',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а html: `р╕Др╕╕р╕Ур╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Вр╕нр╕З: <b>${eventName}</b>`,
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а foundLocation = true;
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а break;
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if (!foundLocation) {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.fire('р╕Щр╕нр╕Бр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣И', 'р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕нр╕вр╕╣р╣Ир╕Щр╕нр╕Бр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ир╕▒р╕Фр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф (р╕гр╕░р╕вр╕░р╕лр╣Ир╕▓р╕Зр╣Ар╕Бр╕┤р╕Щ 10 р╕Бр╕б.)', 'warning');
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а }, 500);
┬а ┬а ┬а ┬а }, error => {
┬а ┬а ┬а ┬а ┬а ┬а Swal.fire('р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф', 'р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╣Др╕Фр╣Й р╣Вр╕Ыр╕гр╕Фр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М', 'error');
┬а ┬а ┬а ┬а });
┬а ┬а });

┬а ┬а form.addEventListener('submit', e => {
┬а ┬а ┬а ┬а e.preventDefault();
┬а ┬а ┬а ┬а Swal.fire({
┬а ┬а ┬а ┬а ┬а ┬а title: 'р╕Бр╕│р╕ер╕▒р╕Зр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е...',
┬а ┬а ┬а ┬а ┬а ┬а text: 'р╕Бр╕гр╕╕р╕Ур╕▓р╕гр╕нр╕кр╕▒р╕Бр╕Др╕гр╕╣р╣И',
┬а ┬а ┬а ┬а ┬а ┬а allowOutsideClick: false,
┬а ┬а ┬а ┬а ┬а ┬а didOpen: () => { Swal.showLoading(); }
┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а fetch(scriptURL, { method: 'POST', body: new FormData(form)})
┬а ┬а ┬а ┬а ┬а ┬а .then(response => response.json())
┬а ┬а ┬а ┬а ┬а ┬а .then(data => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if (data.result === 'success') {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.fire({
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а icon: 'success',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а title: 'р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╣Ар╕гр╣Зр╕И!',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а showConfirmButton: false,
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а timer: 2000
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }).then(() => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if(liff.isInClient()) {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а liff.closeWindow();
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а } else {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а form.reset();
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а $('#province, #district, #subdistrict, #status').val('').trigger('change');
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а } else { throw new Error(data.error || 'Unknown error occurred'); }
┬а ┬а ┬а ┬а ┬а ┬а })
┬а ┬а ┬а ┬а ┬а ┬а .catch(error => {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а console.error('Error!', error.message);
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Swal.fire('р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф!', `р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Фр╣Й: ${error.message}`, 'error');
┬а ┬а ┬а ┬а ┬а ┬а });
┬а ┬а });
</script>

</body>

</html>
